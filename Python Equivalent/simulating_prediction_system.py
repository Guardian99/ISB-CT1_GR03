# -*- coding: utf-8 -*-
"""Simulating_Prediction_System.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Wds_mXNcz-MO8bYGULgm3g4Xs-w6LX97

### Loading the saved model
"""

!pip install wandb

import pandas as pd
from joblib import load
import warnings
warnings.filterwarnings("ignore")


import os
import wandb
import sklearn
from joblib import load
print(sklearn.__version__)

class CarPredictionModel():

    def __init__(self, model, features, rmse):
        self.model = model
        self.features = features
        self.rmse = rmse

os.environ["WANDB_API_KEY"] = "ddb79e032887f0a8e6e54fc954e8fdc8a40c1af2"

run = wandb.init(project="mlops_usedcar", job_type="inference")
artifact = run.use_artifact("Linear_Model_UsedCar:latest")
model_path = artifact.file()

# Load the scikit-learn model
model_v1 = load(model_path)

print(model_v1)

"""### Preparing the record for the new used-car for sale"""

car_dict = {
            'age': 2,
            'KM_Driven' : 5,
            'Fuel_Type' : 'Petrol',
            'Transmission': 'Manual',
            'Owner_Type': 'First',
            'Seats' : 5,
            'make': 'maruti',
            'mileage' : 16,
            'engine': 1000,
            'power': 90,
            'Location': 'Bangalore'
            }

df = pd.DataFrame(car_dict, index = [0])

df

df.shape

"""### Predicting the price of the used car"""

model_v1.predict(df)